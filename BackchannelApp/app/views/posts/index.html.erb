<h1>Listing Posts</h1>

<%= form_tag posts_url, :method => 'get' do%>

<p>
  <%= text_field_tag :search, params[:search]%>
 <%=select(params[:name], :name, ["category", "title", "username", "tag"])%>
  <%= submit_tag "Search", :name => nil %>
</p>
<% end %>


<table >
  <tr>
    <th>Title</th>
    <th>Category</th>
    <th>Tags</th>
    <th>Username</th>
    <th>Votes</th>
    <th>Last Updated</th>
    <th></th>
    <th></th>
    <th></th>
    <th></th>

  </tr>

  <% @posts.each do |post| %>
      <tr>
        <td><%= post.title %></td>
        <td><%= Category.find(post.category_id).name %></td>
        <td><%= post.tag %></td>
        <td><%= User.find(post.user_id).username %></td>
        <td><%= 3 %></td>
        <td><%= post.updated_at %></td>
        <td><%= link_to 'Vote', post if !is_my_post?(post.user_id) %></td>
        <td><%= link_to 'Show', post %></td>
        <td><%= link_to 'Edit', edit_post_path(post) if is_admin? || is_my_post?(post.user_id)%></td>
        <td><%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } if is_admin? || (@current_user && (post.user_id == @current_user.id))%></td>
      </tr>
  <% end %>
</table>

<br />

<%= link_to 'New Post', new_post_path if logged_in? %>
